!function(e,i){void 0===i&&(i={});var t=i.insertAt;if("undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===t&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}("*{box-sizing:border-box}:root{--vw-color-theme:#5f48fb;--vw-color-white:#fff;--vw-color-light-black:#0000001f;--vw-color-light-grey:#f3f3f3;--vw-color-secondary:#666;--vw-color-error:#c13635;--vw-color-verified:#448533}.verifime-widget-wrapper{border:1px solid var(--vw-color-theme);gap:28px;max-width:358px;padding:12px}.verifime-widget-body{height:128px;width:128px}.verifime-widget-no-border{border:0}.verifime-widget-button-main{background-color:var(--vw-color-theme);box-shadow:0 1px 5px 0 var(--vw-color-light-black),0 2px 2px 0 var(--vw-color-light-black),0 3px 1px -2px var(--vw-color-light-black);color:var(--vw-color-white);cursor:pointer;padding:8px 24px;text-decoration:none}.verifime-widget-button-secondary{background-color:var(--vw-color-white);border:1px solid;border-radius:4px;color:var(--vw-color-theme);cursor:pointer;font-weight:600;padding:8px 16px}.verifime-widget-fullwidth{width:100%}.verifime-widget-gap-small{gap:4px}.verifime-widget-gap-large{gap:16px}.verifime-widget-horizontal-center,.verifime-widget-verticial-center{align-items:center;display:flex;justify-content:center}.verifime-widget-verticial-center{flex-direction:column}.verifime-widget-radius{border-radius:4px}.verifime-widget-text-caption{font-size:14px;font-weight:700}.verifime-widget-text-center{text-align:center}.verifime-widget-text-bottom{align-items:end;vertical-align:bottom}.verifime-widget-text-bold{font-size:16px;font-weight:500}.verifime-widget-color-secondary{color:var(--vw-color-secondary)}.verifime-widget-color-error{color:var(--vw-color-error)}.verifime-widget-color-verified{color:var(--vw-color-verified)}.verifime-widget-spiner{animation:verifime-widget-spin 1.2s linear infinite;border-top:4px solid var(--vw-color-light-grey);border:4px solid var(--vw-color-light-grey);border-radius:50%;border-top-color:var(--vw-color-theme);height:32px;width:32px}@keyframes verifime-widget-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}");function e(e,{autoStart:i=!0,pollingIntervalInMs:t=1e3}={autoStart:!0,pollingIntervalInMs:1e3}){let r=null;const o=()=>{r=setInterval((()=>e()),t)};return i&&o(),{startPolling:o,stopPolling:()=>{r&&clearInterval(r),r=null}}}const i="https://widget.static.main.verifime.com/assets",t=async e=>fetch(`https://api.main.verifime.com/v1/user/signup/tracking/${e}/status`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((({status:e})=>e)),r=(e,i)=>`<div id="step-wrapper" class="verifime-widget-wrapper verifime-widget-verticial-center verifime-widget-radius">\n    <span class="verifime-widget-text-caption">Begin verification by clicking the button or\n      scanning the code shown below</span>\n    <div class="verifime-widget-body verifime-widget-verticial-center">${e}</div>\n     <div class="verifime-widget-verticial-center verifime-widget-fullwidth verifime-widget-gap-small">\n      ${i}\n      <a class="verifime-widget-color-secondary verifime-widget-text-center">Provided by VerifiMe | www.verifime.com</a>\n     </div>\n  </div>`,o=()=>r(`<img src="${i}/verified.svg" />`,'<span class="verifime-widget-text-bold verifime-widget-color-verified verifime-widget-text-center">Successfully submitted for verification with VerifiMe</span>'),n=()=>r(`<img src="${i}/error.svg" />`,'<span class="verifime-widget-text-bold verifime-widget-color-error">Something went wrong</span>');class s{constructor(e,i,t){var r;(this.setNextStep=e=>{const i=this.steps.findIndex((i=>i.name===e));i<0||(this.currentStep=i,this.render())},this.currentStep=0,this.steps=i,this.inviteResponse=t,this.element=document.querySelector(e),this.element)?(r="Welcome to use Verifyme Widget",console.log(r),this.render()):console.error("Could not find the element by selector:",e)}render(){const e=this.steps[this.currentStep];e&&(this.element.innerHTML=e.render({setNextStep:this.setNextStep,inviteResponse:this.inviteResponse}))}}const d=(d,c,l)=>{if(!c)return void console.error("Please provide an tracking reference");const a=[{name:"stepStart",render:o=>(({setNextStep:o,inviteResponse:n},{onError:s,onSuccess:d}={})=>{const{stopPolling:c,startPolling:l}=e((async()=>{t(n.trackingReference).then((e=>{"Active"===e&&(c(),o("stepWaiting")),"Completed"===e&&(c(),null==d||d(),o("stepVerified"))})).catch((e=>{console.error(e),c(),null==s||s(),o("stepError")}))}),{autoStart:!1}),a=setTimeout((()=>{c(),l()}),6e4),v=()=>{c(),clearTimeout(a),l()};setTimeout((()=>{const e=document.querySelector("#verifime-wideget-start-button");null==e||e.addEventListener("click",v)}),0);const g=n.qrCodeUrl?`<img src=${n.qrCodeUrl} width="100%" height="100%" />`:"",m=`\n      <a id="verifime-wideget-start-button" class="verifime-widget-button-main verifime-widget-horizontal-center verifime-widget-gap-small verifime-widget-radius verifime-widget-fullwidth verifime-widget-no-border verifime-widget-text-bottom" href=${n.inviteUrl} target="_blank">\n          <span>Verify with</span>\n          <img src="${i}/logo.svg" height="25" width="auto" />\n      </a>\n    `;return r(g,m)})(o,{onError:null==l?void 0:l.onError,onSuccess:null==l?void 0:l.onSuccess})},{name:"stepWaiting",render:i=>(({setNextStep:i,inviteResponse:o},{onError:n,onSuccess:s}={})=>{const{stopPolling:d}=e((async()=>{t(o.trackingReference).then((e=>{"Completed"===e&&(d(),null==s||s(),i("stepVerified"))})).catch((e=>{console.error(e),d(),null==n||n(),i("stepError")}))}));function c(){d(),i("stepStart")}return setTimeout((()=>{const e=document.querySelector("#verifime-widget-try-again-button");null==e||e.addEventListener("click",c)}),0),r('\n    <div class="verifime-widget-verticial-center verifime-widget-gap-large">\n      <div class="verifime-widget-spiner"></div>\n      <button id="verifime-widget-try-again-button" class="verifime-widget-button-secondary">TRY AGAIN</button>\n    </div>\n  ','\n    <div class="verifime-widget-text-bold">Verifying with VerifiMe</div>\n  ')})(i,{onError:null==l?void 0:l.onError,onSuccess:null==l?void 0:l.onSuccess})},{name:"stepVerified",render:o},{name:"stepError",render:n}],v=`https://portal.main.verifime.com/sign-up/track-id/${c}`,g={trackingReference:c,inviteUrl:v,qrCodeUrl:`https://qr-code.dev.verifime.com/qr?url=${encodeURIComponent(v)}`};return new s(d,a,g)};export{d as default};
